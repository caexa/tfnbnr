<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>tfnbnr â€“ study together</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" href="data:,">
  <style>
    :root{
      --accent:#f43f5e;--accent-light:#fb7185;
      --bg:#ffffff;--card:#fafafa;--text:#111827;--muted:#6b7280;
      --radius:12px;--shadow:0 4px 12px rgba(0,0,0,.06);
    }
    body.dark{--bg:#111827;--card:#1f2937;--text:#f9fafb;--muted:#9ca3af;}
    *{box-sizing:border-box;margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;}
    body{background:var(--bg);color:var(--text);line-height:1.55;padding:0 .75rem 2rem;transition:background .3s,color .3s}
    header{display:flex;align-items:center;justify-content:space-between;padding:1.25rem 0 .5rem}
    h1{font-size:1.85rem;font-weight:800;letter-spacing:-.5px}
    .toggle{appearance:none;width:44px;height:24px;background:var(--muted);border-radius:999px;position:relative;cursor:pointer}
    .toggle::after{content:"";position:absolute;width:20px;height:20px;background:#fff;border-radius:50%;top:2px;left:2px;transition:.3s}
    .toggle:checked{background:var(--accent)}.toggle:checked::after{transform:translateX(20px)}
    main{max-width:900px;margin:0 auto}
    section{background:var(--card);border-radius:var(--radius);padding:1.25rem 1.5rem 1.5rem;box-shadow:var(--shadow);margin-bottom:1.25rem}
    label{font-size:.8rem;color:var(--muted);display:block;margin-bottom:.25rem}
    select,input{width:100%;padding:.55rem .65rem;border:1px solid #d1d5db;border-radius:var(--radius);font-size:.95rem;margin-bottom:.9rem}
    .row{display:flex;gap:.5rem}
    .row .field{flex:1}
    button.cta{width:100%;padding:.7rem;border:none;border-radius:var(--radius);background:var(--accent);color:#fff;font-size:1rem;font-weight:600;cursor:pointer;transition:.2s}
    button.cta:hover{background:var(--accent-light)}
    .progress-bar{height:10px;background:#e5e7eb;border-radius:5px;overflow:hidden;margin-top:.4rem}
    .progress-bar div{height:100%;background:var(--accent);width:0%;transition:width .4s}
  </style>
</head>
<body>
  <header>
    <h1>tfnbnr</h1>
    <div>
      <label><input type="checkbox" class="toggle" id="darkToggle"> Dark</label>
    </div>
  </header>

  <main>
    <section>
      <h2>Solo Focus Timer</h2>
      <div class="row">
        <div class="field">
          <label for="soloMinutes">Minutes</label>
          <input id="soloMinutes" type="number" min="0" max="999" step="1" value="25" />
        </div>
        <div class="field">
          <label for="soloSeconds">Seconds (0â€“59)</label>
          <input id="soloSeconds" type="number" min="0" max="59" step="1" value="0" />
        </div>
      </div>

      <button class="cta" id="startSolo">Start focus</button>
      <button class="cta" id="resetSolo" style="margin-top:.5rem;background:#6b7280">Reset</button>

      <div class="progress-bar"><div id="soloProgress"></div></div>
      <p style="text-align:center;margin-top:.5rem;font-size:1.5rem;font-weight:700" id="soloTimer">25:00</p>
    </section>
  </main>

  <script type="module">
  const $ = (sel) => document.querySelector(sel);
  const startBtn = $("#startSolo");
  const resetBtn = $("#resetSolo");
  const minutesInput = $("#soloMinutes");
  const secondsInput = $("#soloSeconds");
  const timerText = $("#soloTimer");
  const progressFill = $("#soloProgress");

  let timerState = "idle";
  let startEpoch = 0;
  let elapsed = 0;
  let duration = 25 * 60 * 1000;
  let rafId = null;

  const clamp = (v,min,max)=>Math.max(min,Math.min(max,Number.isFinite(v)?v:0));
  const fmt = (tMs)=>{
    const s = Math.max(0, Math.ceil(tMs/1000));
    const m = Math.floor(s/60).toString().padStart(2,"0");
    const ss = (s%60).toString().padStart(2,"0");
    return `${m}:${ss}`;
  };

  function readInputs(){
    const mins = clamp(Number(minutesInput.value),0,999);
    let secs = clamp(Number(secondsInput.value),0,59);
    if(mins===0 && secs===0) secs=1;
    minutesInput.value=mins; secondsInput.value=secs;
    return {mins,secs};
  }

  function setDurationFromInput(){
    const {mins,secs}=readInputs();
    duration = (mins*60+secs)*1000;
    timerText.textContent = fmt(duration);
    progressFill.style.width="0%";
  }

  function updateUI(remaining){
    const pct = 100 - Math.min(100,(remaining/duration)*100);
    progressFill.style.width=`${pct}%`;
    timerText.textContent=fmt(remaining);
  }

  function tick(){
    const now=Date.now();
    const running=now-startEpoch;
    const total=elapsed+running;
    const remain=Math.max(0,duration-total);
    updateUI(remain);

    if(remain<=0){
      cancelAnimationFrame(rafId); rafId=null;
      timerState="idle"; elapsed=0;
      startBtn.textContent="Start focus";
      minutesInput.disabled=secondsInput.disabled=false;
      progressFill.style.width="100%";
      timerText.textContent="00:00";
      if(navigator.vibrate) navigator.vibrate(200);
      alert("Focus session complete!");
      return;
    }
    rafId=requestAnimationFrame(tick);
  }

  function start(){
    if(timerState==="running") return;
    if(timerState==="idle"){setDurationFromInput();elapsed=0;progressFill.style.width="0%";}
    startEpoch=Date.now();
    timerState="running";
    startBtn.textContent="Pause";
    minutesInput.disabled=secondsInput.disabled=true;
    rafId=requestAnimationFrame(tick);
  }

  function pause(){
    if(timerState!=="running") return;
    cancelAnimationFrame(rafId);
    rafId=null;
    elapsed += Date.now()-startEpoch;
    timerState="paused";
    startBtn.textContent="Resume";
  }

  // ðŸ†• Reset now just clears everything and waits for Start
  function reset(){
    cancelAnimationFrame(rafId);
    rafId=null;
    timerState="idle";
    elapsed=0;
    minutesInput.disabled=secondsInput.disabled=false;
    setDurationFromInput();
    startBtn.textContent="Start focus";
    progressFill.style.width="0%";
  }

  startBtn.addEventListener("click",()=>{
    if(timerState==="idle"||timerState==="paused") start();
    else if(timerState==="running") pause();
  });
  resetBtn.addEventListener("click",reset);
  minutesInput.addEventListener("change",setDurationFromInput);
  secondsInput.addEventListener("change",setDurationFromInput);
  setDurationFromInput();
  </script>
</body>
</html>
