<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>tfnbnr â€“ study together</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" href="data:,">
  <style>
    :root{--accent:#f43f5e;--accent-light:#fb7185;--bg:#ffffff;--card:#fafafa;--text:#111827;--muted:#6b7280;--radius:12px;--shadow:0 4px 12px rgba(0,0,0,.06);}
    body.dark{--bg:#111827;--card:#1f2937;--text:#f9fafb;--muted:#9ca3af;}
    *{box-sizing:border-box;margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;}
    body{background:var(--bg);color:var(--text);line-height:1.55;padding:0 .75rem 2rem;transition:background .3s,color .3s}
    header{display:flex;align-items:center;justify-content:space-between;padding:1.25rem 0 .5rem}
    h1{font-size:1.85rem;font-weight:800;letter-spacing:-.5px}
    .toggle{appearance:none;width:44px;height:24px;background:var(--muted);border-radius:999px;position:relative;cursor:pointer}
    .toggle::after{content:"";position:absolute;width:20px;height:20px;background:#fff;border-radius:50%;top:2px;left:2px;transition:.3s}
    .toggle:checked{background:var(--accent)}.toggle:checked::after{transform:translateX(20px)}
    nav{display:flex;gap:.5rem;margin:.75rem 0 1.5rem;flex-wrap:wrap}
    nav button{flex:1 1 120px;padding:.55rem;border:none;border-radius:var(--radius);background:var(--card);color:var(--text);font-weight:600;cursor:pointer;box-shadow:var(--shadow);transition:.2s}
    nav button.active{background:var(--accent);color:#fff}
    main{max-width:900px;margin:0 auto}
    .view{display:none}.view.active{display:block}
    section{background:var(--card);border-radius:var(--radius);padding:1.25rem 1.5rem 1.5rem;box-shadow:var(--shadow);margin-bottom:1.25rem}
    label{font-size:.8rem;color:var(--muted);display:block;margin-bottom:.25rem}
    select,input{width:100%;padding:.55rem .65rem;border:1px solid #d1d5db;border-radius:var(--radius);font-size:.95rem;margin-bottom:.9rem}
    .row{display:flex;gap:.5rem}
    .row .field{flex:1}
    button.cta{width:100%;padding:.7rem;border:none;border-radius:var(--radius);background:var(--accent);color:#fff;font-size:1rem;font-weight:600;cursor:pointer;transition:.2s}
    button.cta:hover{background:var(--accent-light)}
    .progress-bar{height:10px;background:#e5e7eb;border-radius:5px;overflow:hidden;margin-top:.4rem}
    .progress-bar div{height:100%;background:var(--accent);width:0%;transition:width .4s}
    #authSection{text-align:center;margin-bottom:1rem}
  </style>
</head>
<body>
  <header>
    <h1>tfnbnr</h1>
    <div>
      <label><input type="checkbox" class="toggle" id="darkToggle"> Dark</label>
    </div>
  </header>

  <!-- Auth (visible) -->
  <div id="authSection">
    <button class="cta" id="googleBtn">Sign in with Google</button>
    <button class="cta" id="mailBtn">Sign in with e-mail link</button>
    <p id="userP"></p>
    <button class="cta hidden" id="outBtn">Sign out</button>
  </div>

  <!-- UNHIDDEN nav + main -->
  <nav id="nav">
    <button class="active" data-view="solo">Solo</button>
    <button data-view="compete">1-v-1</button>
    <button data-view="leader">Leaders</button>
    <button data-view="profile">Profile</button>
  </nav>

  <main id="main">
    <!-- Solo -->
    <div class="view active" id="solo">
      <section>
        <h2>Solo Focus Timer</h2>
        <label>Course</label><select id="soloCourse"></select>

        <div class="row">
          <div class="field">
            <label for="focusMinutes">Minutes</label>
            <input id="focusMinutes" type="number" min="0" max="999" step="1" value="25" />
          </div>
          <div class="field">
            <label for="focusSeconds">Seconds (0â€“59)</label>
            <input id="focusSeconds" type="number" min="0" max="59" step="1" value="0" />
          </div>
        </div>

        <!-- ðŸ” renamed IDs -->
        <button class="cta" id="focusStartBtn">Start focus</button>
        <button class="cta" id="focusResetBtn" style="margin-top:.5rem;background:#6b7280">Reset</button>

        <div class="progress-bar"><div id="focusProgress"></div></div>
        <p style="text-align:center;margin-top:.5rem;font-size:1.5rem;font-weight:700" id="focusTimerText">25:00</p>
      </section>
    </div>

    <!-- 1v1 -->
    <div class="view" id="compete">
      <section>
        <h2>Find a live opponent</h2>
        <label>Course</label><select id="compCourse"></select>
        <button class="cta" id="findMatch">Find match</button>
        <div id="matchArea"></div>
      </section>
    </div>

    <!-- leaders -->
    <div class="view" id="leader">
      <section><h2>Daily Solo Leaders</h2><div id="soloLeader"></div></section>
      <section><h2>Competitive Wins</h2><div id="compLeader"></div></section>
    </div>

    <!-- profile -->
    <div class="view" id="profile">
      <section>
        <h2>Your Card</h2>
        <p><strong id="cardName">â€”</strong></p>
        <p>Focus minutes: <b id="cardMin">0</b></p>
        <p>Wins: <b id="cardWins">0</b></p>
        <p>Level: <b id="cardLvl">Rookie</b></p>
        <button class="cta" id="resetProf">Reset my data</button>
      </section>
    </div>
  </main>

  <!-- Your other app code can still load; it just won't touch the new IDs -->
  <script type="module" src="tfnbnr.js"></script>

  <!-- Timer logic (namespaced to new IDs) -->
  <script type="module">
  const $ = (s)=>document.querySelector(s);
  const startBtn = $("#focusStartBtn");
  const resetBtn = $("#focusResetBtn");
  const minIn = $("#focusMinutes");
  const secIn = $("#focusSeconds");
  const timerTxt = $("#focusTimerText");
  const bar = $("#focusProgress");

  let state="idle", startTime=0, elapsed=0, duration=25*60*1000, raf=null;

  const clamp=(v,min,max)=>Math.max(min,Math.min(max,Number.isFinite(v)?v:0));
  const fmt=(ms)=>{const s=Math.max(0,Math.ceil(ms/1000));
    const m=Math.floor(s/60).toString().padStart(2,"0");
    const ss=(s%60).toString().padStart(2,"0"); return `${m}:${ss}`;};

  function readInputs(){
    const m=clamp(+minIn.value,0,999);
    let s=clamp(+secIn.value,0,59);
    if(m===0 && s===0) s=1;
    minIn.value=m; secIn.value=s;
    return {m,s};
  }

  function setDuration(){
    const {m,s}=readInputs();
    duration=(m*60+s)*1000;
    timerTxt.textContent=fmt(duration);
    bar.style.width="0%";
  }

  function update(rem){
    const pct=100 - Math.min(100,(rem/duration)*100);
    bar.style.width=`${pct}%`;
    timerTxt.textContent=fmt(rem);
  }

  function tick(){
    const now=Date.now();
    const run=now-startTime;
    const total=elapsed+run;
    const rem=Math.max(0,duration-total);
    update(rem);
    if(rem<=0){
      cancelAnimationFrame(raf); raf=null;
      state="idle"; elapsed=0;
      startBtn.textContent="Start focus";
      minIn.disabled=secIn.disabled=false;
      bar.style.width="100%"; timerTxt.textContent="00:00";
      if(navigator.vibrate) navigator.vibrate(200);
      alert("Focus session complete!");
      return;
    }
    raf=requestAnimationFrame(tick);
  }

  function start(){
    if(state==="running") return;
    if(state==="idle"){ setDuration(); elapsed=0; bar.style.width="0%"; }
    startTime=Date.now();
    state="running";
    startBtn.textContent="Pause";
    minIn.disabled=secIn.disabled=true;
    raf=requestAnimationFrame(tick);
  }

  function pause(){
    if(state!=="running") return;
    cancelAnimationFrame(raf); raf=null;
    elapsed += Date.now() - startTime;   // keep elapsed so resume is exact
    state="paused";
    startBtn.textContent="Resume";
  }

  function reset(){
    cancelAnimationFrame(raf); raf=null;
    state="idle"; elapsed=0;
    minIn.disabled=secIn.disabled=false;
    setDuration();
    startBtn.textContent="Start focus";
    bar.style.width="0%";
  }

  startBtn.addEventListener("click", ()=> {
    if(state==="idle" || state==="paused") start();
    else if(state==="running") pause();
  });
  resetBtn.addEventListener("click", reset);
  minIn.addEventListener("change", setDuration);
  secIn.addEventListener("change", setDuration);
  setDuration();
  </script>
</body>
</html>



